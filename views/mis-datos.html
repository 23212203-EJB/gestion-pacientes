<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mis Datos - Enfermero</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container my-5">

  <h2 class="mb-4">Mis Datos</h2>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand" href="/index.html">
      <i class="bi bi-hospital"></i> Hospital
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
            data-bs-target="#navbarNav" aria-controls="navbarNav" 
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto" id="menuOpciones"></ul>
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-danger" href="/logout">
            <i class="bi bi-box-arrow-right"></i> Cerrar Sesión
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<script>
  fetch('/api/session-user')
    .then(res => res.json())
    .then(user => {
      const menu = document.getElementById('menuOpciones');
      if (!user) return;

      if (user.tipo_usuario == 1) {
        // Administrador
        menu.innerHTML = `
          <li class="nav-item">
            <a class="nav-link" href="/gestionar-usuarios.html">
              <i class="bi bi-people"></i> Gestionar Usuarios
            </a>
          </li>
        `;
      } else if (user.tipo_usuario == 2) {
        // Enfermero
        menu.innerHTML = `
          <li class="nav-item">
            <a class="nav-link" href="/mis-datos.html">
              <i class="bi bi-person-badge"></i> Mis Datos
            </a>
          </li>
        `;
      }
    })
    .catch(err => console.error("Error cargando menú:", err));
</script>

  <!-- Aquí se mostrarán los datos -->
  <div id="datosEnfermero"></div>

  <script>
  fetch('/api/mis-datos')
    .then(res => res.json())
    .then(data => {
      const contenedor = document.getElementById('datosEnfermero');

      if (data) {
        contenedor.innerHTML = `
          <div class="card shadow-sm">
            <div class="card-body">
              <h5 class="card-title">Información del Enfermero</h5>
              <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Nombre:</strong> ${data.nombre_enfermero}</li>
                <li class="list-group-item"><strong>Apellido:</strong> ${data.apellido}</li>
                <li class="list-group-item"><strong>Ubicación:</strong> ${data.ubicacion}</li>
              </ul>
              <div class="mt-3">
                <a href="/mis-datos-editar.html" class="btn btn-primary">Editar</a>
                <a href="/index.html" class="btn btn-secondary">Regresar</a>
              </div>
            </div>
          </div>
        `;
      } else {
        contenedor.innerHTML = `
          <div class="alert alert-warning">
            No tienes datos registrados aún. 
            <a href="/formulario-enfermero.html" class="alert-link">Haz clic aquí para registrarlos</a>.
          </div>
        `;
      }
    })
    .catch(err => console.error("Error cargando datos del enfermero:", err));
</script>
</body>
</html>
